let s=null;function m(){fetch("/get_cars",{method:"GET"}).then(t=>t.json()).then(t=>{let l=document.getElementById("car-list");for(let n of t.car_list){let a=document.createElement("div");a.setAttribute("class","card"),a.setAttribute("onclick","renderDetails(car.car_id)");let e=document.createElement("div");e.setAttribute("class","flex-inline");let d=document.createElement("img");d.setAttribute("src",n.image_url),e.appendChild(d);let o=document.createElement("h2");o.textContent=n.car_name,e.appendChild(o);let i=document.createElement("p");i.textContent=n.car_status,e.appendChild(i),a.appendChild(e),l.appendChild(a)}})}function p(t,l,n){fetch(`https://api.openrouteservice.org/v2/directions/driving-car?api_key=eyJvcmciOiI1YjNjZTM1OTc4NTExMTAwMDFjZjYyNDgiLCJpZCI6ImUwZTRmZGQ4ZDQxYjQ4ZjRiNTZjOGVlYzMzNTEzZDM2IiwiaCI6Im11cm11cjY0In0=&start=${t.lng},${t.lat}&end=${l.lng},${l.lat}`,{method:"GET"}).then(e=>e.json()).then(e=>{console.log(e.features[0].properties.summary);let d=document.getElementById("route-info"),o=document.createElement("h2");o.textContent="VzdialenosÅ¥",d.appendChild(o);let i=document.createElement("p");i.textContent=Math.round(e.features[0].properties.summary.distance/1e3)+" km",d.appendChild(i);let c=document.createElement("h2");c.textContent="Trvanie",d.appendChild(c);let r=document.createElement("p");r.textContent=e.features[0].properties.summary.duration/60+" h",d.appendChild(r),s=L.geoJSON(e).addTo(n)})}document.addEventListener("DOMContentLoaded",()=>{let t=[],l=[],n=L.map("map").setView([48.727103,19.120248],13);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(n),n.on("click",a=>{if(t.length<=2&&(t.push(L.marker(a.latlng).addTo(n)),l.push(a.latlng),t.length===2&&p(l[0],l[1],n)),t.length>2){s.removeFrom(n);for(const e of t)e.remove();t=[],l=[]}}),document.getElementById("open-assisted").addEventListener("click",a=>{document.getElementById("choices").style.display="none",document.getElementById("assisted").style.display="block",n.invalidateSize()}),document.getElementById("open-manual").addEventListener("click",()=>{m(),document.getElementById("choices").style.display="none",document.getElementById("manual").style.display="block"}),document.getElementById("open-trip").addEventListener("click",()=>{console.log("open-trip"),document.getElementById("choices").style.display="none",document.getElementById("trip").style.display="block"})});
